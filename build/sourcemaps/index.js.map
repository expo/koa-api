{"version":3,"sources":["index.js"],"names":[],"mappings":";;AAAA,IAAI,CAAC,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAC/B,IAAI,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;;AAEnC,IAAI,QAAQ,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACrC,IAAI,UAAU,GAAG,OAAO,CAAC,cAAc,CAAC,CAAC;;AAEzC,MAAM,CAAC,OAAO,GAAG,UAAU,GAAG,EAAE,WAAW,EAAE,MAAM,EAAE,IAAI,EAAE;;AAEzD,MAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,EAAE;AAC/B,QAAI,GAAG,MAAM,CAAC;GACf,MAAM,IAAI,CAAC,MAAM,EAAE;AAClB,UAAM,GAAG,GAAG,CAAC;GACd;;AAED,MAAI,CAAC,IAAI,EAAE;AACT,QAAI,GAAG,EAAE,CAAC;GACX;;AAED,MAAI,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,IAAI,MAAM,CAAC;;AAEpC,MAAI,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC;;;;;AAKlC,MAAI,EAAE,GAAG,UAAU,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;AACvC,gBAAc,CAAC,GAAG,CAAC,oBAAoB,EAAE,EAAE,CAAC,CAAC;AAC7C,KAAG,CAAC,GAAG,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,CAAC;AACjC,KAAG,CAAC,GAAG,CAAC,cAAc,CAAC,cAAc,EAAE,CAAC,CAAC;;AAEzC,SAAO,WAAW,IAAI,EAAE;AACtB,UAAM,IAAI,CAAC;GACZ,CAAC;CAEH,CAAC;;AAEF,MAAM,CAAC,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC","file":"index.js","sourcesContent":["let _ = require('lodash-node');\nlet router = require('koa-router');\n\nlet ApiError = require('./ApiError');\nlet callMethod = require('./callMethod');\n\nmodule.exports = function (app, apiInstance, prefix, opts) {\n\n  if (_.isObject(prefix) && !opts) {\n    opts = prefix;\n  } else if (!prefix) {\n    prefix = '/';\n  }\n\n  if (!opts) {\n    opts = {};\n  }\n\n  opts.prefix = opts.prefix || prefix;\n\n  let endpointRouter = router(opts);\n\n  // endpointRouter.all('/api/:method/:jsonArgs', api.callMethod);\n  // let endpointRouter = router({ prefix: '/--' });\n\n  let cm = callMethod(apiInstance, opts);\n  endpointRouter.all('/:method/:jsonArgs', cm);\n  app.use(endpointRouter.routes());\n  app.use(endpointRouter.allowedMethods());\n\n  return function* (next) {\n    yield next;\n  };\n\n};\n\nmodule.exports.ApiError = ApiError;\n"],"sourceRoot":"/source/"}